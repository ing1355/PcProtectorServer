<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="oms.pc_protector.restApi.manager.mapper.ManagerMapper">


    <select id="findAll" resultType="oms.pc_protector.restApi.manager.model.ManagerVO">
        SELECT * FROM manager
    </select>

    <select id="searchManager" parameterType="oms.pc_protector.restApi.manager.model.SearchManagerVO"
            resultType="oms.pc_protector.restApi.manager.model.ManagerVO">
        SELECT * FROM manager
        WHERE 1 = 1
        <if test='id != null and id != ""'>
            AND id LIKE CONCAT('%',#{id},'%')
        </if>
        <if test='name != null and name != ""'>
            AND name LIKE CONCAT('%',#{name},'%')
        </if>
        <if test='mobile != null and mobile != ""'>
            AND mobile LIKE CONCAT('%',#{mobile},'%')
        </if>
        <if test='email != null and email != ""'>
            AND email LIKE CONCAT('%',#{email},'%')
        </if>
        ORDER BY idx DESC
    </select>

    <select id="findById" resultType="oms.pc_protector.restApi.manager.model.ResponseManagerVO">
        SELECT * FROM manager WHERE id = #{id}
    </select>

    <select id="selectSameId" resultType="int" parameterType="String">
        SELECT COUNT(*) FROM manager WHERE id = #{value}
    </select>

    <insert id="insertManager" parameterType="oms.pc_protector.restApi.manager.model.ManagerVO">
        INSERT INTO manager (id,
                             name,
                             password,
                             mobile,
                             email)
        VALUES (#{id},
                #{name},
                #{password},
                #{mobile},
                #{email});
    </insert>

    <delete id="deleteManager" parameterType="String">
        DELETE
        FROM manager
        WHERE manager.id = #{value};
        SET @COUNT = 0;
        UPDATE manager
        SET manager.idx = @COUNT := @COUNT + 1;
    </delete>

    <update id="updateManagerInfo" parameterType="oms.pc_protector.restApi.manager.model.ManagerVO">
        UPDATE manager
        SET name   = #{name},
            mobile = #{mobile},
            email  = #{email},
            password = #{password}
        WHERE id = #{id};
    </update>

</mapper>


